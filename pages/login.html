<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Login - Portal de Eventos</title>

    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="manifest" href="../manifest.webmanifest">

    <script defer src="../assets/js/config.js"></script>
    <script defer src="../assets/js/auth.js"></script>
    <script defer src="../assets/js/pwa.js"></script>
</head>
<body>

<header class="header">
    <div class="logo">Portal de Eventos</div>
    <nav class="nav"></nav>
</header>

<div class="form-container">
    <h2>Entrar</h2>

    <div class="form-group">
        <label>Email</label>
        <input type="email" id="email" placeholder="seu@email.com">
    </div>

    <div class="form-group">
        <label>Senha</label>
        <input type="password" id="senha" placeholder="••••••">
    </div>

    <button id="btnLogin" class="btn-full">Entrar</button>

    <p style="text-align:center;margin-top:10px;">
        <a href="cadastro.html">Criar Conta</a>
    </p>
</div>

<footer class="footer">
    © 2025 Sistema de Eventos
</footer>

<script>
document.getElementById("btnLogin").onclick = async () => {
    const emailVal = document.getElementById("email").value.trim();
    const senhaVal = document.getElementById("senha").value.trim();

    if (!emailVal || !senhaVal) {
        alert("Preencha todos os campos.");
        return;
    }

    const result = await realizarLogin(emailVal, senhaVal);

    if (!result) {
        alert("Credenciais inválidas.");
        return;
    }

    if (result.tipo === "novo") {
        window.location.href = "cadastro.html";
        return;
    }

    if (result.tipo === "precisa_completar") {
        window.location.href = `completar_cadastro.html?email=${encodeURIComponent(emailVal)}`;
        return;
    }

    window.location.href = "home.html";
};
</script>

</body>
</html>
