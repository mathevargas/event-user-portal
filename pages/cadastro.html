<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Criar Conta</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="manifest" href="../manifest.webmanifest">

    <script defer src="../assets/js/config.js"></script>
    <script defer src="../assets/js/auth.js"></script>
    <script defer src="../assets/js/security.js"></script>
    <script src="../assets/js/pwa.js"></script>
</head>
<body>

<header class="header">
    <div class="logo">Portal de Eventos</div>
    <nav class="nav"></nav>
</header>

<div class="form-container">
    <h2>Criar Conta</h2>

    <div class="form-group">
        <label>Nome</label>
        <input id="nome" placeholder="Seu nome completo">
    </div>

    <div class="form-group">
        <label>Email</label>
        <input id="email" type="email" placeholder="nome@email.com">
    </div>

    <div class="form-group">
        <label>Senha</label>
        <input id="senha" type="password" placeholder="Sua senha">
    </div>

    <button id="btnCadastrar" class="btn-full">Criar Conta</button>
</div>

<footer class="footer">Â© 2025 Sistema de Eventos</footer>

<script>
document.getElementById("btnCadastrar").onclick = async () => {
    const nomeVal = document.getElementById("nome").value.trim();
    const emailVal = document.getElementById("email").value.trim();
    const senhaVal = document.getElementById("senha").value.trim();

    if (!nomeVal || !emailVal || !senhaVal) {
        alert("Preencha todos os campos.");
        return;
    }

    const resp = await fetch(`${CONFIG.AUTH_API}/auth/cadastrar`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            nome: nomeVal,
            email: emailVal,
            senha: senhaVal
        })
    });

    if (!resp.ok) {
        const txt = await resp.text();
        alert("Erro ao cadastrar: " + txt);
        return;
    }

    const dados = await resp.json();
    salvarSessao(dados);

    alert("Conta criada com sucesso!");
    window.location.href = "login.html";
};
</script>

</body>
</html>
