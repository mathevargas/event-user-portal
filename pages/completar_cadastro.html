<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Finalizar Cadastro</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <script defer src="../assets/js/auth.js"></script>
</head>

<body>

<header class="header">
    <div class="logo">Portal de Eventos</div>
    <nav class="nav">
        <a href="home.html">Home</a>
        <a href="login.html">Login</a>
    </nav>
</header>

<div class="form-container">
    <h2>Finalizar Cadastro</h2>

    <div class="form-group">
        <label for="email">Email</label>
        <input id="email" disabled>
    </div>

    <div class="form-group">
        <label for="nome">Nome</label>
        <input id="nome" placeholder="Seu nome completo">
    </div>

    <div class="form-group">
        <label for="senha">Nova senha</label>
        <input type="password" id="senha" placeholder="••••••••">
    </div>

    <div class="form-group">
        <label for="senha2">Confirmar senha</label>
        <input type="password" id="senha2" placeholder="••••••••">
    </div>

    <button id="btnSalvar" class="btn-full">Salvar e entrar</button>
</div>

<footer class="footer">
    © 2025 Sistema de Eventos
</footer>

<script>
    // pegar email da url
    const params = new URLSearchParams(location.search);
    const emailParam = params.get("email");

    const inputEmail = document.getElementById("email");
    const inputNome = document.getElementById("nome");
    const inputSenha = document.getElementById("senha");
    const inputSenha2 = document.getElementById("senha2");
    const btn = document.getElementById("btnSalvar");

    inputEmail.value = emailParam;

    // salvar novo cadastro
    btn.onclick = async () => {
        const nome = inputNome.value.trim();
        const s1 = inputSenha.value.trim();
        const s2 = inputSenha2.value.trim();

        if (!nome || !s1 || !s2) {
            alert("Preencha todos os campos.");
            return;
        }

        if (s1 !== s2) {
            alert("As senhas não coincidem.");
            return;
        }

        const r = await completarCadastro(emailParam, nome, s1);

        if (!r) {
            alert("Erro ao completar cadastro.");
            return;
        }

        location.href = "home.html";
    };
</script>

</body>
</html>
